<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew" />


<title>At-home Statistical Workout üí™üí™üí™üí™</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">At-home Statistical Workout üí™üí™üí™üí™</h1>
<h4 class="author">Andrew</h4>

</div>


<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE)</code></pre>
<p>Here are some suggested ideas for how to work out your likelihood skills!</p>
<p>They are divided into three sections: one, two and three parameters.</p>
<p><strong>NOTE</strong> remember to consult the slides above for a step-by-step pseudocode approach</p>
<p><strong>To do an exercise: </strong> copy and paste the R code into an R source file. Run it, then work with the data.frame it creates!</p>
<div id="one-parameter" class="section level2">
<h2>One parameter</h2>
<div id="one-parameter-exponential-distribution" class="section level3">
<h3>One-parameter exponential distribution</h3>
<p>You are watching a female bird visiting her nest, bringing back food for nestlings. Every time she comes back you write down the number of minutes since the last visit. You watch for 20 consecutive visits. This species brings food once every 10 minutes, so six times an hour, and visits are prefectly random. This implies an Exponential distribution with a rate of <span class="math inline">\(6\text{visits} / 60\text{minutes}\)</span> so in other words <span class="math inline">\(0.1\)</span> visits per minute. Use maximum likelihood to confirm this number</p>
<pre class="r"><code>visit_rate &lt;- 6/60
set.seed(1859)
time_between_visit &lt;- rexp(20, rate = visit_rate)
bird_visits &lt;- data.frame(times = time_between_visit)

hist(time_between_visit)</code></pre>
<p><img src="exercise_questions_files/figure-html/bird-visits-1.png" width="672" /></p>
<p>Questions / thoughts:</p>
<ol style="list-style-type: decimal">
<li>Begin by trying only positive numbers in your algorithm.</li>
<li>Run the the following <code>rexp(1, -1)</code>. What happens? Why?</li>
<li>How would you constrain your algorithm to use only positive numbers?</li>
</ol>
</div>
<div id="monarch-butterfly-numbers" class="section level3">
<h3>Monarch Butterfly numbers</h3>
<p>You are concerned about Monarchs, so you‚Äôve decided to count their eggs! You look on 50 milkweed plants in your neighbourhood to find them. The eggs follow a perfect Poisson distribution with a mean of 120 eggs per plant.</p>
<pre class="r"><code>mean_eggs &lt;- 120
set.seed(1859)
counted_eggs &lt;- rpois(50, mean_eggs)
egg_data &lt;- data.frame(counted_eggs)

hist(counted_eggs)</code></pre>
<p><img src="exercise_questions_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>You want to use Maximum Likelihood to look at this distribution. You want to be extra careful, so you want to do it two ways.</p>
<p>First, you try to fit a Poisson distribution like this:</p>
<p><span class="math display">\[
\text{eggs} \sim \text{Poisson}(\lambda)
\]</span></p>
<p>you do this by searching over values of lambda between 1 and 200</p>
<p>Lambda can‚Äôt be 0 or negative. You decide to replace the value of <span class="math inline">\(\lambda\)</span> with a function that is always greater than 0:</p>
<p><span class="math display">\[
f(x) = e^x
\]</span></p>
<pre class="r"><code>curve(exp(x), xlim = c(-3, 3))</code></pre>
<p><img src="exercise_questions_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Since this function is always positive, and <span class="math inline">\(\lambda\)</span> is always positive, you decide to put the function in for the <span class="math inline">\(\lambda\)</span> of the Poisson:</p>
<p><span class="math display">\[
\text{eggs} \sim \text{Poisson}(e^x)
\]</span></p>
<p><strong>Questions</strong>:</p>
<ol style="list-style-type: decimal">
<li>Now what values should you use for <span class="math inline">\(x\)</span> ?</li>
<li>Are your answers from the two methods the same?</li>
</ol>
</div>
<div id="difference-between-two-normal-distributions-part-i" class="section level3">
<h3>Difference between two normal distributions (part I)</h3>
<p>You add some fertilizer to plants, because experiments. This makes the plants grow more on average, because physiology. At the end of your experiment, you cut all the plants down and measure their dry biomass, because tradition.</p>
<p>As a skilled botanist, you know that the standard deviation of the control plots will be exactly 5g, and the standard deviation of the treatment plants will be *<strong>exactly the same</strong>. You know that plants are on average 200g, and the fertilizer should increase this by 30g (a 15% increase).</p>
<pre class="r"><code>real_difference &lt;- 30
set.seed(1859)
control_plants &lt;- rnorm(300, mean = 200, sd = 5)

treated_plants &lt;- rnorm(300, mean = 200 + real_difference, sd = 5)

plant_growth &lt;- rbind(
  data.frame(treatment = 0, mass = control_plants),
  data.frame(treatment = 1, mass = treated_plants)
)

par(mfrow = c(2,1))
hist(control_plants, breaks = 15)
hist(treated_plants, breaks = 15)</code></pre>
<p><img src="exercise_questions_files/figure-html/normal-diff-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1,1))</code></pre>
<p><strong>Questions</strong></p>
<ol style="list-style-type: decimal">
<li>What is the likelihood for the observations? Consider that you know the control mean (<span class="math inline">\(\mu\)</span>), the standard deviation (<span class="math inline">\(\sigma\)</span>). What is missing? Call this missing quantity <span class="math inline">\(\alpha\)</span>.</li>
<li>Use maximum likelihood to confirm that the difference is really 30g</li>
</ol>
</div>
<div id="difference-between-two-normal-distributions-part-ii" class="section level3">
<h3>Difference between two normal distributions part (II)</h3>
<p>The fertilizer makes plants grow, but affects different plants differently, because genetics.</p>
<p>As a VERY skilled geneticist, you know that the standard deviation of the control plots will be exactly 5g, but now you also know the standard deviation of the treatment plants will be exactly 9g. You know that plants are on average 200g, and the fertilizer should increase this by 30g (a 15% increase).</p>
<pre class="r"><code>real_difference &lt;- 30
set.seed(1859)
control_plants2 &lt;- rnorm(300, mean = 200, sd = 5)

treated_plants2 &lt;- rnorm(300, mean = 200 + real_difference, sd = 9)

plant_growth2 &lt;- rbind(
  data.frame(treatment = 0, mass = control_plants),
  data.frame(treatment = 1, mass = treated_plants)
)

par(mfrow = c(2,1))
hist(control_plants2, breaks = 15)
hist(treated_plants2, breaks = 15)</code></pre>
<p><img src="exercise_questions_files/figure-html/normal-diff2-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1,1))</code></pre>
<p><strong>Questions</strong></p>
<ol style="list-style-type: decimal">
<li>What is the likelihood for the observations? Consider that you know the control mean (<span class="math inline">\(\mu\)</span>), the control standard deviation (<span class="math inline">\(\sigma_c\)</span>) and the treatment standard deviation (<span class="math inline">\(\sigma_t\)</span>). How is this different from the first equation?</li>
<li>Use maximum likelihood to confirm that the difference is really 30g</li>
<li>Is the likelihood profile different from the first exercise? that is, does the plot of likelihood values (y axis) against parameter values (x axis) look the same?</li>
</ol>
</div>
</div>
<div id="two-parameters" class="section level2">
<h2>Two parameters</h2>
<p><em>The following two examples are lifted from Bolker , page 182</em></p>
<p>Consider some tadpoles, who live a difficult life. They are in an experiment where they are kept at different densities. The experimenter introduces a predator to the container with the tadpoles, and observes as the predator kills tadpoles.</p>
<p>The experiment has six treatments: 5, 10, 15, 20, 25, 30 tadpoles per tank, and 5 tanks per treatment.</p>
<p>Predators can feed more when prey density is higher, but sometimes slow down when the prey get to very high densities. In a classic Type II functional response, this is modelled with two numbers. First, a predator species has some constant attack rate <span class="math inline">\(a\)</span> ‚Äì they only need to eat so much per unit time. Second, they must ‚Äúhandle‚Äù each prey item (kill, digest, etc) before attacking another. This handling time creates the slowdown in attack: no matter how many prey there are, they still take the same effort to catch, kill, and digest.</p>
<p>The Type II functional response is written as:</p>
<p><span class="math display">\[
f(N) = \frac{a}{a + ahN}
\]</span></p>
<ul>
<li><span class="math inline">\(a\)</span> is the attack rate</li>
<li><span class="math inline">\(h\)</span> is handling time</li>
<li><span class="math inline">\(N\)</span> is the number of prey</li>
</ul>
<p>This equation produces a per capita rate of predation: the <em>proportion</em> of prey killed by one predator in a unit of time.</p>
<p>Play with this equation in R, using <code>curve()</code>, and modify values of <code>a</code> and <code>h</code>.</p>
<pre class="r"><code>a &lt;- 0.7
h &lt;- 1.3
curve(a/(1 + a*h*x), xlim = c(0,30), ylim = c(0,1))</code></pre>
<p><img src="exercise_questions_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Convince yourself that the output is always between 0 and 1. Are there any constraints on the parameters? Think about how you will handle that in your Maximum Likelihood search.</p>
<p>At the end of the experiment, the scientist comes back and measures how many tadpoles were killed in each treatment, out of the total number originally placed in that tank. What probability distribution would you use for these data? Where do you place the functional response equation explored above?</p>
<div id="part-2" class="section level4">
<h4>Part 2</h4>
<p>Simulate some data with known parameters for <span class="math inline">\(a = 0.6\)</span> and <span class="math inline">\(h = 0.3\)</span></p>
<pre class="r"><code>a &lt;- 0.7
h &lt;- 1.3
rbinom(5,prob =  a/(1 + a*h*10), size = 10)</code></pre>
<pre><code>## [1] 1 0 1 2 1</code></pre>
<p><em>(to be continued!)</em></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
